{% extends "base.html" %}

{% block title %}用户中心{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user_center.css') }}">
{% endblock %}

{% block body %}
    <div class="row mt-5">
        <div class="col">
        </div>
        <div class="col-10 mr-5" id="user">
            <div class="row">
                <div class="col-3">
                    <div class="nav flex-column" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                        <div class="side-question">
                            <a href="{{ url_for('user.change_icon') }}">
                                 <img class="side-question-avatar" src="/static/img/{{ user.id }}.jpg"
                                 alt="">
                            </a>
                        </div>
                        <div style="display: flex;margin-bottom: 10px;margin-left: 10px">
                            <span class="badge badge-pill badge-dark">文章: ({{ questions|length }})</span>
                            <span class="badge badge-pill badge-dark">收藏: ({{ collects|length }})</span>
                            <span class="badge badge-pill badge-dark">关注: ({{ collects|length }})</span>
                        </div>
                        <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home"
                           role="tab" aria-controls="v-pills-home" aria-selected="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-person" viewBox="0 0 16 16">
                                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                            </svg>
                            个人中心
                        </a>
                        <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile"
                           role="tab" aria-controls="v-pills-profile" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-send" viewBox="0 0 16 16">
                                <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"/>
                            </svg>
                            我的发布</a>
                        <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages"
                           role="tab" aria-controls="v-pills-messages" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-heart" viewBox="0 0 16 16">
                                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                            </svg>
                            我的收藏</a>
                        <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings"
                           role="tab" aria-controls="v-pills-settings" aria-selected="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-people" viewBox="0 0 16 16">
                                <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
                            </svg>
                            用户管理
                        </a>
                    </div>
                </div>
                <div class="col-9">
                    <div class="tab-content" id="v-pills-tabContent">
                        <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                             aria-labelledby="v-pills-home-tab">
                            <table class="table table-bordered table-dark">
                                <thead>
                                <tr>
                                    <th scope="col">用户名：</th>
                                    <th scope="col">{{ user.username }}</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <th>邮箱：</th>
                                    <td>{{ user.email }}</td>
                                </tr>
                                <tr>
                                    <th scope="row">创建时间：</th>
                                    <td>{{ user.join_time }}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="v-pills-profile" role="tabpanel"
                             aria-labelledby="v-pills-profile-tab">
                            {% if questions|length != 0 %}
                                <ul class="question-ul" style="margin-left: -30px;">
                                    {% for question in questions %}
                                        <li>
                                            <div class="question-main">
                                                <div class="question-title"><a href="{{ url_for('qa.question_detail',
                                        question_id = question.id) }}">{{ question.title }}</a></div>
                                                <div class="question-content">{{ question.content }}</div>
                                                <div class="question-detail">
                                                    <small class="question-time">{{ question.create_time }}</small>
                                                </div>
                                            </div>
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <div class="card text-light bg-dark"
                                     style="margin-left: 12rem; width: 18rem; height: 10rem">
                                    <div class="card-body">
                                        <h5 class="card-title">注意!</h5>
                                        <p class="card-text">你还没有发布过文章</p>
                                        <div style="text-align: right">
                                            <a href="{{ url_for('qa.public_question') }}"
                                               class="btn btn-outline-success">前往发布</a>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <div class="tab-pane fade" id="v-pills-messages" role="tabpanel"
                             aria-labelledby="v-pills-messages-tab">
                            <ul class="question-ul" style="margin-left: -30px;">
                                {% for collect in collects %}
                                    <li>
                                        <div class="question-main">
                                            <div class="question-title"><a href="{{ url_for('qa.question_detail',
                                        question_id = collect.question_id) }}">{{ collect.question.title }}</a></div>
                                        </div>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="tab-pane fade" id="v-pills-settings" role="tabpanel"
                             aria-labelledby="v-pills-settings-tab">
                            {% if user.id == 1 %}
                                <div style="display: flex">
                                    <form class="form-inline my-2 my-lg-0" method="GET"
                                          action="{{ url_for('qa.search') }}">
                                        <input class="form-control mr-sm-2" type="search" placeholder="输入用户id"
                                               aria-label="Search" name="q">
                                        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">查找</button>
                                    </form>
                                        <button type="button" class="btn btn-outline-primary">
                                            添加
                                        </button>
                                </div>
                                <table class="table">
                                    <thead class="thead-dark">
                                    <tr>
                                        <th scope="col">id</th>
                                        <th scope="col">姓名</th>
                                        <th scope="col">邮箱</th>
                                        <th scope="col">操作</th>
                                    </tr>
                                    </thead>
                                    {% for user in users %}
                                        <tbody style="color: #9fcdff">
                                        <tr>
                                            <th scope="row">{{ user.id }}</th>
                                            <td>{{ user.username }}</td>
                                            <td>{{ user.email }}</td>
                                            <td>
                                                <button type="button" class="btn btn-outline-warning badge badge-dark">
                                                    修改
                                                </button>
                                                <a type="button" class="btn btn-outline-danger badge badge-dark" href="{{ url_for('user.delete', user_id=user.id) }}">
                                                    删除
                                                </a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    {% endfor %}
                                </table>
                            {% else %}
                                <div class="card text-white bg-secondary mb-3"
                                     style="max-width: 18rem;margin-left: 200px;">
                                    <div class="card-header">抱歉！</div>
                                    <div class="card-body">
                                        <h5 class="card-title">你不是管理员，无法访问</h5>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">

        </div>
    </div>

{% endblock %}
